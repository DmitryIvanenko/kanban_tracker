# üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Ç–∏–∫–µ—Ç–æ–≤ –≤ —Å—Ç–∞–¥–∏—è—Ö

## üìê –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞

### **–û—Å–Ω–æ–≤–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:**
```
–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤ —Å—Ç–∞–¥–∏–∏ = Œ£(–≤—Ä–µ–º—è_–≤_—Å—Ç–∞–¥–∏–∏_i) / –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–µ—Ä–µ—Ö–æ–¥–æ–≤_–≤_—Å—Ç–∞–¥–∏—é
```

### **–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞ –ø–æ —à–∞–≥–∞–º:**

#### 1Ô∏è‚É£ **–°–±–æ—Ä –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤**

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–∫–µ—Ç–∞:
```
–¢–∏–∫–µ—Ç ‚Üí –ò—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π ‚Üí –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø–æ —Å—Ç–∞–¥–∏—è–º
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è —Ç–∏–∫–µ—Ç–∞ #1:**
```
–°–æ–∑–¥–∞–Ω –≤ "–ë—ç–∫–ª–æ–≥"     ‚Üí 10:00
–ü–µ—Ä–µ–º–µ—â–µ–Ω –≤ "–í —Ä–∞–±–æ—Ç–µ" ‚Üí 11:00  (–≤—Ä–µ–º—è –≤ –ë—ç–∫–ª–æ–≥–µ: 1 —á–∞—Å)
–ü–µ—Ä–µ–º–µ—â–µ–Ω –≤ "–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏" ‚Üí 13:00  (–≤—Ä–µ–º—è –í —Ä–∞–±–æ—Ç–µ: 2 —á–∞—Å–∞)
–ó–∞–≤–µ—Ä—à–µ–Ω ‚Üí 15:00  (–≤—Ä–µ–º—è –ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏: 2 —á–∞—Å–∞)
```

#### 2Ô∏è‚É£ **–ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å—Ç–∞–¥–∏—è–º**

```javascript
stage_durations = {
    "–ë—ç–∫–ª–æ–≥": [1.0, 0.5, 2.3, ...],           // —á–∞—Å—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∏–∫–µ—Ç–æ–≤
    "–í —Ä–∞–±–æ—Ç–µ": [2.0, 1.2, 0.8, ...],         // —á–∞—Å—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∏–∫–µ—Ç–æ–≤  
    "–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏": [2.0, 3.5, 1.1, ...]   // —á–∞—Å—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∏–∫–µ—Ç–æ–≤
}
```

#### 3Ô∏è‚É£ **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π**

```python
for stage_name in ["–ë—ç–∫–ª–æ–≥", "–í —Ä–∞–±–æ—Ç–µ", "–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏"]:
    times = stage_durations[stage_name]
    if times:
        average_hours = sum(times) / len(times)
        average_days = average_hours / 24
        tickets_count = len(times)
```

## üîç **–î–µ—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞**

### **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞–¥–∏–π:**
```python
# –ú–∞–ø–ø–∏–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫ –∫ —Å—Ç–∞–¥–∏—è–º –ø–æ –ø–æ–∑–∏—Ü–∏–∏
column_to_stage = {
    1: "–ë—ç–∫–ª–æ–≥",           # –ü–µ—Ä–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞
    2: "–í —Ä–∞–±–æ—Ç–µ",         # –í—Ç–æ—Ä–∞—è –∫–æ–ª–æ–Ω–∫–∞  
    4: "–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏"   # –¢—Ä–µ—Ç—å—è –∫–æ–ª–æ–Ω–∫–∞
}
```

### **–†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ç–∏–∫–µ—Ç–∞:**

```python
# –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
current_stage = "–ë—ç–∫–ª–æ–≥"
stage_start_time = ticket.created_at

# –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
for move in ticket_history:
    if move.action == "move":
        # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ç–µ–∫—É—â—É—é —Å—Ç–∞–¥–∏—é
        duration = move.created_at - stage_start_time
        hours = duration.total_seconds() / 3600
        stage_durations[current_stage].append(hours)
        
        # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–æ–≤—É—é —Å—Ç–∞–¥–∏—é
        current_stage = get_new_stage(move.to_column)
        stage_start_time = move.created_at

# –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ —Å—Ç–∞–¥–∏–∏
current_duration = datetime.now() - stage_start_time
current_hours = current_duration.total_seconds() / 3600
stage_durations[current_stage].append(current_hours)
```

## üìä **–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞**

### **–î–∞–Ω–Ω—ã–µ –ø–æ —Å—Ç–∞–¥–∏–∏ "–ë—ç–∫–ª–æ–≥":**
```
–¢–∏–∫–µ—Ç #1: 1.0 —á–∞—Å
–¢–∏–∫–µ—Ç #2: 2.6 —á–∞—Å–∞  
–¢–∏–∫–µ—Ç #3: 0.02 —á–∞—Å–∞
–¢–∏–∫–µ—Ç #4: 0.5 —á–∞—Å–∞
...–≤—Å–µ–≥–æ 53 –∑–Ω–∞—á–µ–Ω–∏—è
```

### **–†–∞—Å—á–µ—Ç:**
```
–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è = (1.0 + 2.6 + 0.02 + 0.5 + ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ) / 53
               = 585.18 / 53  
               = 11.06 —á–∞—Å–æ–≤
               = 0.46 –¥–Ω–µ–π
```

## ‚öôÔ∏è **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

1. **–£—á–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏**: –î–ª—è —Ç–∏–∫–µ—Ç–æ–≤, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ, –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤—Ä–µ–º—è –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –¥–æ —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω**: 
   ```python
   if stage_entry_time.tzinfo is None:
       current_time = datetime.utcnow()
   else:
       current_time = datetime.now(timezone.utc)
   ```

3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –ò—Å–∫–ª—é—á–∞—é—Ç—Å—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏

4. **–¢–æ—á–Ω–æ—Å—Ç—å**: –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–∫—Ä—É–≥–ª—è–µ—Ç—Å—è –¥–æ 2 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π

## üìà **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**

### **–¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:**
- **–ë—ç–∫–ª–æ–≥**: —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è **11,06 —á–∞—Å–æ–≤** (0,46 –¥–Ω–µ–π) –ø–æ 53 –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è–º
- **–í —Ä–∞–±–æ—Ç–µ**: —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è **11,25 —á–∞—Å–æ–≤** (0,47 –¥–Ω–µ–π) –ø–æ 50 –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è–º  
- **–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏**: —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è **47,34 —á–∞—Å–æ–≤** (1,97 –¥–Ω–µ–π) –ø–æ 14 –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è–º

### **–ê–Ω–∞–ª–∏–∑:**
- **–ë—ç–∫–ª–æ–≥ (11.06 —á)**: –¢–∏–∫–µ—Ç—ã –≤ —Å—Ä–µ–¥–Ω–µ–º –∂–¥—É—Ç –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã ~11 —á–∞—Å–æ–≤
- **–í —Ä–∞–±–æ—Ç–µ (11.25 —á)**: –ê–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç ~11 —á–∞—Å–æ–≤  
- **–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏ (47.34 —á)**: –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —Å–∞–º—ã–π –¥–æ–ª–≥–∏–π ~2 –¥–Ω—è

## üéØ **–¶–µ–ª—å –º–µ—Ç—Ä–∏–∫–∏**

–≠—Ç–∞ —Ñ–æ—Ä–º—É–ª–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã. –í—ã—Å–æ–∫–æ–µ –≤—Ä–µ–º—è –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ç–∞–¥–∏–∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å:

- –£–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
- –£–ø—Ä–æ—â–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä—É—Ç–∏–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- –£–ª—É—á—à–µ–Ω–∏—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**

### **Backend (Python/FastAPI):**
- –§—É–Ω–∫—Ü–∏—è `calculate_stage_time_statistics()` –≤ `backend/app/main.py`
- –ê–Ω–∞–ª–∏–∑ —Ç–∞–±–ª–∏—Ü—ã `card_history` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π
- API endpoint `/api/statistics` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON

### **Frontend (React/Material-UI):**
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `Statistics.jsx` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Ä–µ–º—è –≤ —á–∞—Å–∞—Ö, –¥–Ω—è—Ö –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∏–∫–µ—Ç–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º –∏ –¥–∞—Ç–∞–º

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2024-12-19*  
*–í–µ—Ä—Å–∏—è: 1.0* 