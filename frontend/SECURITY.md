# Безопасность фронтенда

## Защита от XSS атак

В проекте реализована комплексная защита от XSS (Cross-Site Scripting) атак.

### Установленные библиотеки

- **DOMPurify 3.0.8** - библиотека для санитизации HTML контента

### Компоненты безопасности

#### 1. Утилиты санитизации (`src/utils/sanitizer.js`)

Содержит функции для безопасной обработки пользовательского ввода:

- `sanitizeUserInput()` - основная функция санитизации с тремя уровнями:
  - `STRICT` - только текст, HTML удаляется полностью
  - `BASIC` - разрешены безопасные теги форматирования (b, i, em, strong, br, p)
  - `COMMENTS` - дополнительно разрешены списки (ul, ol, li)

- `validateAndSanitizeTitle()` - валидация названий тикетов
- `validateAndSanitizeComment()` - валидация комментариев
- `containsSuspiciousContent()` - детекция подозрительного контента

#### 2. Безопасные компоненты (`src/components/SafeHTML.jsx`)

Специализированные React компоненты для безопасного отображения:

- `SafeHTML` - базовый компонент с настраиваемым уровнем санитизации
- `SafeComment` - для комментариев (уровень COMMENTS)
- `SafeTitle` - для названий (уровень STRICT)
- `SafeDescription` - для описаний (уровень BASIC)
- `SafeTag` - для тегов (уровень STRICT)

### Защищенные места

#### ✅ Исправленные уязвимости:

1. **CommentsSection.jsx**
   - Отображение содержимого комментариев
   - Валидация при создании комментариев

2. **KanbanColumn.jsx**
   - Названия карточек задач
   - Названия колонок
   - Названия тегов

3. **CreateTicketModal.jsx**
   - Валидация названий при создании
   - Санитизация описаний
   - Санитизация тегов

4. **EditTicketModal.jsx**
   - Валидация названий при редактировании
   - Санитизация описаний
   - Санитизация тегов

### Уровни защиты

#### Входная валидация
- Проверка на подозрительные паттерны
- Ограничения по длине
- Санитизация перед отправкой на сервер

#### Выходная санитизация  
- Все пользовательские данные обрабатываются через SafeHTML компоненты
- Использование `dangerouslySetInnerHTML` только с предварительно очищенным контентом

#### Детекция угроз
Автоматическое обнаружение опасных паттернов:
- `<script>` теги
- `javascript:` протокол
- Обработчики событий (`onclick`, `onload`, etc.)
- Data URI с HTML
- Другие потенциально опасные конструкции

### Рекомендации разработчикам

1. **Всегда используйте SafeHTML компоненты** для отображения пользовательского контента
2. **Не используйте `dangerouslySetInnerHTML`** напрямую без санитизации
3. **Валидируйте ввод** на стороне клиента перед отправкой
4. **Тестируйте с потенциально опасным контентом** типа `<script>alert('XSS')</script>`

### Тестирование безопасности

Для проверки защиты можно использовать тестовые payload'ы:

```javascript
// Примеры потенциально опасного контента для тестирования:
const xssPayloads = [
  '<script>alert("XSS")</script>',
  '<img src="x" onerror="alert(\'XSS\')">',
  'javascript:alert("XSS")',
  '<iframe src="javascript:alert(\'XSS\')"></iframe>',
  '<svg onload="alert(\'XSS\')"></svg>'
];
```

Все эти payload'ы должны быть безопасно обработаны системой.

### Производительность

- Санитизация выполняется только при необходимости
- Кэширование результатов в React компонентах
- Минимальное влияние на производительность приложения

### Обновления безопасности

Регулярно обновляйте DOMPurify до последней версии для получения новых правил безопасности:

```bash
npm update dompurify
``` 